## Application

The application can be managed using the `bin/app` script, from any PHP service **container**. You can enter the container to run the commands or execute them directly from current working directory.

```shell
docker exec -it skeleton-dev-be-app-php-1 bash
bin/app --help
```
```shell
docker exec skeleton-dev-be-app-php-1 bin/app --help
```

## Tests
Application testing is divided into two independent test groups. The `quality` group performs static code analysis to check its quality and potential errors that may occur during runtime. The `code` group conducts tests directly on the code and determines the code coverage of the application. In the case of CI/CD, both groups are executed in parallel to reduce the overall testing time.

## Test: Quality
Running the group: `bin/app test --quality` or selectively: `bin/app test phpcs psalm`

| order | name    | bin (php tech image)   | config path                          |
|-------|---------|------------------------|--------------------------------------|
| 1     | phpmd   | /usr/local/bin/phpmd   | etc/config/test/quality/phpmd.xml    |
| 2     | phpcs   | /usr/local/bin/phpcs   | etc/config/test/quality/phpcs.xml    |
| 3     | psalm   | /usr/local/bin/psalm   | etc/config/test/quality/psalm.xml    |
| 4     | phpstan | /usr/local/bin/phpstan | etc/config/test/quality/phpstan.neon |

These tools can be integrated with an IDE (e.g., PHPStorm) by configuring the interpreter to point to the executable paths within the image and their respective configurations.

## Test: Code
Running the group: `bin/app test --code` or selectively: `bin/app test phpunit`

| order | name     | bin                  | config path                         |
|-------|----------|----------------------|-------------------------------------|
| 1     | phpunit  | /etc/gateway/tst.php | etc/config/test/quality/phpunit.xml |
| 2     | coverage | ↓                    | ↓                                   |

Although `coverage` can be run selectively, it requires a report to be generated by running `phpunit`.

## Debug
Every PHP image from the `tech` group, has Xdebug installed, which works in trigger mode. To trigger the step debugger, in the case of an HTTP request you need to set a cookie with a key named `XDEBUG_SESSION` with any value, in the case of a CLI call you need to set an environment variable with the same name.
